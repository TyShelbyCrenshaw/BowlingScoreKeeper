@inject IGame CurrentGame

<div>
    <div>
        Select the number of pins knocked down
    </div>
    <div class="my-3 row justify-content-between">
        <div class="col">
@*             @if( CurrentGame.CurrentFrameIndex < 9)
            {
                @for (var i = 0; i <= 10 - (CurrentGame.CurrentFrame.FirstRoll ?? 0); i++)
                {
                    int pinsKnocked = i;
                    <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                }
            }
            else
            {
                //if we are first roll we how 10

                //if we are second roll 
                //if we are stike we have 10 
                //else 10 - first roll

                //if we are the third
                //do we get to roll again only if we got either a strike in the first roll or a spare in the second
                //if we got a spare in the second we get 10
                //if we got a strike in the first but didn't get 10 in the second we get 10 - second roll
                //if we got a strike in the first and a strike in the second we get 10
            } *@
            @if (CurrentGame.CurrentFrameIndex < 9)
            {
                @for (var i = 0; i <= 10 - (CurrentGame.CurrentFrame.FirstRoll ?? 0); i++)
                {
                    int pinsKnocked = i;
                    <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                }
            }
            else
            {
                @if (CurrentGame.CurrentFrame.FirstRoll == null)
                {
                    // First roll of 10th frame: always show 0-10
                    @for (var i = 0; i <= 10; i++)
                    {
                        int pinsKnocked = i;
                        <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                    }
                }
                else if (CurrentGame.CurrentFrame.SecondRoll == null)
                {
                    // Second roll of 10th frame
                    @if (CurrentGame.CurrentFrame.FirstRoll == 10)
                    {
                        // If first roll was a strike, show 0-10
                        @for (var i = 0; i <= 10; i++)
                        {
                            int pinsKnocked = i;
                            <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                        }
                    }
                    else
                    {
                        // If not a strike, show remaining pins
                        @for (var i = 0; i <= 10 - CurrentGame.CurrentFrame.FirstRoll.Value; i++)
                        {
                            int pinsKnocked = i;
                            <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                        }
                    }
                }
                else if (CurrentGame.CurrentFrame.ThirdRoll == null)
                {
                    // Third roll of 10th frame
                    @if (CurrentGame.CurrentFrame.FirstRoll == 10 || CurrentGame.CurrentFrame.FirstRoll + CurrentGame.CurrentFrame.SecondRoll == 10)
                    {
                        // If we had a strike in the first and didn't get a strike in the second then it is 10 - second roll
                        @if (CurrentGame.CurrentFrame.FirstRoll == 10 && CurrentGame.CurrentFrame.SecondRoll != 10)
                        {
                            // If not a strike, show remaining pins
                            @for (var i = 0; i <= 10 - CurrentGame.CurrentFrame.SecondRoll.Value; i++)
                            {
                                int pinsKnocked = i;
                                <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                            }
                        }
                        else
                        {
                            // If strike on first roll or spare, show 0-10
                            @for (var i = 0; i <= 10; i++)
                            {
                                int pinsKnocked = i;
                                <button class="me-3" @onclick="() => AddRoll(pinsKnocked)" @onclick:preventDefault>@i</button>
                            }
                        }
                    }
                    // If no third roll is allowed, this section won't be rendered
                }
            }

        </div>

@*         If I want to keep working on this project I could add multiplayer
        <div class="col text-end">
            <button @onclick="AddNewGame">Add Another Game</button>
        </div> *@
    </div>
</div>

@code {
    public void AddRoll(int pinsKnocked)
    {
        CurrentGame.AddRoll(pinsKnocked);
    }
}